
<!DOCTYPE html>
<html lang="zh-Hans">


<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#202020"/>
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>
  
  
    <meta name="keywords" content="轮子工具,POI,Excel," />
  

  
    <meta name="description" content="纪录一些看到的好文，收藏起来" />
  
  
  <link rel="icon" type="image/x-icon" href="/logo.png">
  <title>POI-Excel的导出导入 [ 每天拾柴火 ]</title>
  
    <!-- stylesheets list from config.yml -->
    
      <link rel="stylesheet" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css">
    
      <link rel="stylesheet" href="/css/xoxo.css">
    
  
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="每天拾柴火" type="application/atom+xml">
</head>


<body>
  <div class="nav-container">
    <nav class="home-menu pure-menu pure-menu-horizontal">
  <a class="pure-menu-heading" href="/">
    <img class="avatar" src="https://kanchai.club/images/logo.png">
    <span class="title">每天拾柴火</span>
  </a>

  <ul class="pure-menu-list clearfix">
      
          
            <li class="pure-menu-item"><a href="/" class="pure-menu-link">首页</a></li>
          
      
          
            <li class="pure-menu-item"><a href="/archives" class="pure-menu-link">归档</a></li>
          
      
          
            <li class="pure-menu-item"><a href="/tags" class="pure-menu-link">标签</a></li>
          
      
          
            <li class="pure-menu-item"><a href="/search" class="pure-menu-link">搜索</a></li>
          
      
          
            <li class="pure-menu-item"><a href="/about" class="pure-menu-link">关于</a></li>
          
      
          
            <li class="pure-menu-item"><a href="/atom.xml" class="pure-menu-link">订阅</a></li>
          
      
  </ul>
   
</nav>
  </div>

  <div class="container" id="content-outer">
    <div class="inner" id="content-inner">
      <div class="post-container">
  <article class="post" id="post">
    <header class="post-header text-center">
      <h1 class="title">
        POI-Excel的导出导入
      </h1>
      <span>
        
        <time class="time" datetime="2020-03-17T15:36:46.688Z">
        2020-03-17
      </time>
        
      </span>
      <span class="slash">/</span>
      <span class="post-meta">
      <span class="post-tags">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Excel/" rel="tag">Excel</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/POI/" rel="tag">POI</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%BD%AE%E5%AD%90%E5%B7%A5%E5%85%B7/" rel="tag">轮子工具</a></li></ul>
      </span>
    </span>
      <span class="slash">/</span>
      <span class="read">
      <span id="busuanzi_value_page_pv"></span> 点击
    </span>
      <span class="slash">/</span>
      <span class="read">阅读耗时 21 分钟</span>
    </header>

    <div class="post-content">
      <p><a href="https://996.icu" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/link-996.icu-red.svg" alt="996.icu"></a><br><a href="https://github.com/996icu/996.ICU/blob/master/LICENSE" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/license-Anti%20996-blue.svg" alt="LICENSE"></a></p>
<h1 id="excel-poi"><a href="#excel-poi" class="headerlink" title="excel-poi"></a>excel-poi</h1><h4 id="maven使用方式"><a href="#maven使用方式" class="headerlink" title="maven使用方式"></a>maven使用方式</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- excel导入导出 --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.github.stupdit1t&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;poi-excel&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.3&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><blockquote>
<p>本工程并没有使用注解方式实现，完全是编码方式。个人觉得注解方式对代码侵入比较大。不如纯编码方便，请以maven版本为主，此源码可能不是最新版本。环境为，POI4.0.1 ，JDK1.8</p>
</blockquote>
<h3 id="导入"><a href="#导入" class="headerlink" title="导入"></a>导入</h3><ol>
<li>支持严格的单元格校验</li>
<li>支持数据行的图片导入</li>
<li>3支持数据回调处理</li>
<li>03和07都支持</li>
</ol>
<h3 id="导出"><a href="#导出" class="headerlink" title="导出"></a>导出</h3><ol>
<li>动态表头+表尾</li>
<li>支持List<Map>数据</li>
<li>支持图片导出，</li>
<li>支持复杂对象的导出</li>
<li>支持回调处理数据后再导出</li>
<li>支持单元格的样式设置</li>
<li>支持模板导出</li>
<li>导出03和07都支持，默认为03，具体看以下使用方式</li>
<li>支持多sheet导出</li>
</ol>
<h3 id="选择03还是07？"><a href="#选择03还是07？" class="headerlink" title="选择03还是07？"></a>选择03还是07？</h3><ol>
<li>03速度较快，单sheet最大65535行，体积大</li>
<li>07速度慢，单sheet最大1048576行，体积小</li>
</ol>
<h2 id="主要功能："><a href="#主要功能：" class="headerlink" title="主要功能："></a>主要功能：</h2><h3 id="导入-1"><a href="#导入-1" class="headerlink" title="导入"></a>导入</h3><p>1.简单的导入:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.获取源文件</span></span><br><span class="line">Workbook wb = WorkbookFactory.create(<span class="keyword">new</span> FileInputStream(<span class="string">"src\\test\\java\\excel\\imports\\import.xlsx"</span>));</span><br><span class="line"><span class="comment">// 2.获取sheet0导入</span></span><br><span class="line">Sheet sheet = wb.getSheetAt(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// 3.生成VO数据</span></span><br><span class="line"><span class="comment">//参数：1.生成VO的class类型;2.校验规则;3.导入的sheet;3.从第几行导入;4.尾部非数据行数量</span></span><br><span class="line">ImportRspInfo&lt;ProjectEvaluate&gt; list = ExcelUtils.parseSheet(ProjectEvaluate<span class="class">.<span class="keyword">class</span>, <span class="title">EvaluateVerifyBuilder</span>.<span class="title">getInstance</span>(), <span class="title">sheet</span>, 3, 2)</span>;</span><br><span class="line"><span class="keyword">if</span> (list.isSuccess()) &#123;</span><br><span class="line">	<span class="comment">// 导入没有错误，打印数据</span></span><br><span class="line">	System.out.println(JSON.toJSONString(list.getData()));</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="comment">// 导入有错误，打印输出错误</span></span><br><span class="line">	System.out.println(list.getMessage());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2.复杂导入，带图片导入，带回调处理</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.获取源文件</span></span><br><span class="line">Workbook wb = WorkbookFactory.create(<span class="keyword">new</span> FileInputStream(<span class="string">"src\\test\\java\\excel\\imports\\import.xlsx"</span>));</span><br><span class="line"><span class="comment">// 2.获取sheet0导入</span></span><br><span class="line">Sheet sheet = wb.getSheetAt(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// 3.生成VO数据</span></span><br><span class="line"><span class="comment">//参数：1.生成VO的class类型;2.校验规则;3.导入的sheet;3.从第几行导入;4.尾部非数据行数量;5.导入每条数据的回调</span></span><br><span class="line">ImportRspInfo&lt;ProjectEvaluate&gt; list = ExcelUtils.parseSheet(ProjectEvaluate<span class="class">.<span class="keyword">class</span>, <span class="title">ProjectVerifyBuilder</span>.<span class="title">getInstance</span>(), <span class="title">sheet</span>, 3, 2, (<span class="title">row</span>, <span class="title">rowNum</span>) -&gt; </span>&#123;</span><br><span class="line">	<span class="comment">//1.此处可以完成更多的校验</span></span><br><span class="line">	<span class="keyword">if</span>(row.getAreaName() == <span class="string">"中青旅"</span>)&#123;</span><br><span class="line">	    <span class="keyword">throw</span> <span class="keyword">new</span> POIException(<span class="string">"第"</span>+rowNum+<span class="string">"行，区域名字不能为中青旅！"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//2.图片导入，再ProjectEvaluate定义类型为byte[]的属性就可以，ProjectVerifyBuilder定义ImgVerfiy校验列.就OK了</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">if</span> (list.isSuccess()) &#123;</span><br><span class="line">	<span class="comment">// 导入没有错误，打印数据</span></span><br><span class="line">	System.out.println(JSON.toJSONString(list.getData()));</span><br><span class="line">	<span class="comment">//打印图片byte数组长度</span></span><br><span class="line">	<span class="keyword">byte</span>[] img = list.getData().get(<span class="number">0</span>).getImg();</span><br><span class="line">	System.out.println(img);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="comment">// 导入有错误，打印输出错误</span></span><br><span class="line">	System.out.println(list.getMessage());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3.自定义校验器，导入需要校验字段,必须继承AbstractVerifyBuidler</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProjectVerifyBuilder</span> <span class="keyword">extends</span> <span class="title">AbstractVerifyBuidler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> ProjectVerifyBuilder builder = <span class="keyword">new</span> ProjectVerifyBuilder();</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ProjectVerifyBuilder <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> builder;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 定义列校验实体：提取的字段、提取列、校验规则</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="title">ProjectVerifyBuilder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		cellEntitys.add(<span class="keyword">new</span> CellVerifyEntity(<span class="string">"projectName"</span>, <span class="string">"B"</span>, <span class="keyword">new</span> StringVerify(<span class="string">"项目名称"</span>, <span class="keyword">true</span>)));</span><br><span class="line">		cellEntitys.add(<span class="keyword">new</span> CellVerifyEntity(<span class="string">"areaName"</span>, <span class="string">"C"</span>, <span class="keyword">new</span> StringVerify(<span class="string">"所属区域"</span>, <span class="keyword">true</span>)));</span><br><span class="line">		cellEntitys.add(<span class="keyword">new</span> CellVerifyEntity(<span class="string">"province"</span>, <span class="string">"D"</span>, <span class="keyword">new</span> StringVerify(<span class="string">"省份"</span>, <span class="keyword">true</span>)));</span><br><span class="line">		cellEntitys.add(<span class="keyword">new</span> CellVerifyEntity(<span class="string">"city"</span>, <span class="string">"E"</span>, <span class="keyword">new</span> StringVerify(<span class="string">"市"</span>, <span class="keyword">true</span>)));</span><br><span class="line">		cellEntitys.add(<span class="keyword">new</span> CellVerifyEntity(<span class="string">"people"</span>, <span class="string">"F"</span>, <span class="keyword">new</span> StringVerify(<span class="string">"项目所属人"</span>, <span class="keyword">true</span>)));</span><br><span class="line">		cellEntitys.add(<span class="keyword">new</span> CellVerifyEntity(<span class="string">"leader"</span>, <span class="string">"G"</span>, <span class="keyword">new</span> StringVerify(<span class="string">"项目领导人"</span>, <span class="keyword">true</span>)));</span><br><span class="line">		cellEntitys.add(<span class="keyword">new</span> CellVerifyEntity(<span class="string">"scount"</span>, <span class="string">"H"</span>, <span class="keyword">new</span> IntegerVerify(<span class="string">"总分"</span>, <span class="keyword">true</span>)));</span><br><span class="line">		cellEntitys.add(<span class="keyword">new</span> CellVerifyEntity(<span class="string">"avg"</span>, <span class="string">"I"</span>, <span class="keyword">new</span> DoubleVerify(<span class="string">"历史平均分"</span>, <span class="keyword">true</span>)));</span><br><span class="line">		cellEntitys.add(<span class="keyword">new</span> CellVerifyEntity(<span class="string">"createTime"</span>, <span class="string">"J"</span>, <span class="keyword">new</span> DateTimeVerify(<span class="string">"创建时间"</span>, <span class="string">"yyyy-MM-dd HH:mm"</span>, <span class="keyword">true</span>)));</span><br><span class="line">		cellEntitys.add(<span class="keyword">new</span> CellVerifyEntity(<span class="string">"img"</span>, <span class="string">"K"</span>, <span class="keyword">new</span> ImgVerify(<span class="string">"图片"</span>, <span class="keyword">false</span>)));</span><br><span class="line">		<span class="comment">// 必须调用</span></span><br><span class="line">		<span class="keyword">super</span>.init();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="导入示例图"><a href="#导入示例图" class="headerlink" title="导入示例图"></a>导入示例图</h4><p><img src="https://images.gitee.com/uploads/images/2018/1118/104015_a439ba1a_1215820.png" alt="输入图片说明" title="QQ截图20181118104004.png"></p>
<h3 id="导出-1"><a href="#导出-1" class="headerlink" title="导出"></a>导出</h3><p>0.基础数据构建</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 单sheet数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> List&lt;ProjectEvaluate&gt; sheetData = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * map型数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> List&lt;Map&lt;String, Object&gt;&gt; mapData = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 复杂对象数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> List&lt;Student&gt; complexData = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 多sheet数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> List&lt;List&lt;?&gt;&gt; moreSheetData = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1.单sheet数据填充</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        ProjectEvaluate obj = <span class="keyword">new</span> ProjectEvaluate();</span><br><span class="line">        obj.setProjectName(<span class="string">"中青旅"</span> + i);</span><br><span class="line">        obj.setAreaName(<span class="string">"华东长三角"</span>);</span><br><span class="line">        obj.setProvince(<span class="string">"河北省"</span>);</span><br><span class="line">        obj.setCity(<span class="string">"保定市"</span>);</span><br><span class="line">        obj.setPeople(<span class="string">"张三"</span> + i);</span><br><span class="line">        obj.setLeader(<span class="string">"李四"</span> + i);</span><br><span class="line">        obj.setScount(<span class="number">50</span>);</span><br><span class="line">        obj.setAvg(<span class="number">60.0</span>);</span><br><span class="line">        obj.setCreateTime(<span class="keyword">new</span> Date());</span><br><span class="line">        obj.setImg(ImageParseBytes(<span class="keyword">new</span> File(<span class="string">"src/test/java/excel/export/1.png"</span>)));</span><br><span class="line">        sheetData.add(obj);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 2.map型数据填充</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">15</span>; i++) &#123;</span><br><span class="line">        Map&lt;String, Object&gt; obj = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        obj.put(<span class="string">"name"</span>, <span class="string">"张三"</span> + i);</span><br><span class="line">        obj.put(<span class="string">"age"</span>, <span class="number">5</span> + i);</span><br><span class="line">        mapData.add(obj);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 3.复杂对象数据</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">        <span class="comment">// 學生</span></span><br><span class="line">        Student stu = <span class="keyword">new</span> Student();</span><br><span class="line">        <span class="comment">// 學生所在的班級，用對象</span></span><br><span class="line">        stu.setClassRoom(<span class="keyword">new</span> ClassRoom(<span class="string">"六班"</span>));</span><br><span class="line">        <span class="comment">// 學生的更多信息，用map</span></span><br><span class="line">        Map&lt;String, Object&gt; moreInfo = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        moreInfo.put(<span class="string">"parent"</span>, <span class="keyword">new</span> Parent(<span class="string">"張無忌"</span>));</span><br><span class="line">        stu.setMoreInfo(moreInfo);</span><br><span class="line">        stu.setName(<span class="string">"张三"</span>);</span><br><span class="line">        complexData.add(stu);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 4.多sheet数据填充</span></span><br><span class="line">    moreSheetData.add(sheetData);</span><br><span class="line">    moreSheetData.add(mapData);</span><br><span class="line">    moreSheetData.add(complexData);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>1.简单导出</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.获取导出的数据体</span></span><br><span class="line"> <span class="comment">// 1.导出的hearder设置</span></span><br><span class="line">String[] hearder = &#123;<span class="string">"序号"</span>, <span class="string">"项目名称"</span>, <span class="string">"所属区域"</span>, <span class="string">"省份"</span>, <span class="string">"市"</span>, <span class="string">"项目所属人"</span>, <span class="string">"项目领导人"</span>, <span class="string">"得分"</span>, <span class="string">"平均分"</span>, <span class="string">"创建时间"</span>, <span class="string">"项目图片"</span>&#125;;</span><br><span class="line"><span class="comment">// 2.导出hearder对应的字段设置</span></span><br><span class="line">Column[] column = &#123;Column.field(<span class="string">"projectName"</span>), Column.field(<span class="string">"areaName"</span>), Column.field(<span class="string">"province"</span>),</span><br><span class="line">        Column.field(<span class="string">"city"</span>), Column.field(<span class="string">"people"</span>), Column.field(<span class="string">"leader"</span>), Column.field(<span class="string">"scount"</span>),</span><br><span class="line">        Column.field(<span class="string">"avg"</span>), Column.field(<span class="string">"createTime"</span>),</span><br><span class="line">        <span class="comment">// 项目图片</span></span><br><span class="line">        Column.field(<span class="string">"img"</span>)</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 3.执行导出到工作簿</span></span><br><span class="line">Workbook bean = ExcelUtils.createWorkbook(sheetData, ExportRules.simpleRule(column, hearder).title(<span class="string">"项目资源统计"</span>).sheetName(<span class="string">"mysheet1"</span>).autoNum(<span class="keyword">true</span>), <span class="keyword">true</span>,</span><br><span class="line">        (feildName, value, t, customStyle) -&gt; &#123;</span><br><span class="line">            <span class="comment">//此处指向回调逻辑，可以修改写入excel的值,以及单元格样式，如颜色等</span></span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;);</span><br><span class="line"><span class="comment">// 4.写出文件</span></span><br><span class="line">bean.write(<span class="keyword">new</span> FileOutputStream(<span class="string">"src/test/java/excel/export/export1.xlsx"</span>));</span><br></pre></td></tr></table></figure>

<h4 id="1导出图"><a href="#1导出图" class="headerlink" title="1导出图"></a>1导出图</h4><p><img src="https://images.gitee.com/uploads/images/2018/1215/161804_3ddf0b6b_1215820.png" alt="输入图片说明" title="1.png"></p>
<p>2.复杂表格导出</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.表头设置,可以对应excel设计表头，一看就懂</span></span><br><span class="line">HashMap&lt;String, String&gt; headerRules = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">headerRules.put(<span class="string">"1,1,A,K"</span>, <span class="string">"项目资源统计"</span>);</span><br><span class="line">headerRules.put(<span class="string">"2,3,A,A"</span>, <span class="string">"序号"</span>);</span><br><span class="line">headerRules.put(<span class="string">"2,2,B,E"</span>, <span class="string">"基本信息"</span>);</span><br><span class="line">headerRules.put(<span class="string">"3,3,B,B"</span>, <span class="string">"项目名称"</span>);</span><br><span class="line">headerRules.put(<span class="string">"3,3,C,C"</span>, <span class="string">"所属区域"</span>);</span><br><span class="line">headerRules.put(<span class="string">"3,3,D,D"</span>, <span class="string">"省份"</span>);</span><br><span class="line">headerRules.put(<span class="string">"3,3,E,E"</span>, <span class="string">"市"</span>);</span><br><span class="line">headerRules.put(<span class="string">"2,3,F,F"</span>, <span class="string">"项目所属人"</span>);</span><br><span class="line">headerRules.put(<span class="string">"2,3,G,G"</span>, <span class="string">"市项目领导人"</span>);</span><br><span class="line">headerRules.put(<span class="string">"2,2,H,I"</span>, <span class="string">"分值"</span>);</span><br><span class="line">headerRules.put(<span class="string">"3,3,H,H"</span>, <span class="string">"得分"</span>);</span><br><span class="line">headerRules.put(<span class="string">"3,3,I,I"</span>, <span class="string">"平均分"</span>);</span><br><span class="line">headerRules.put(<span class="string">"2,3,J,J"</span>, <span class="string">"创建时间"</span>);</span><br><span class="line">headerRules.put(<span class="string">"2,3,K,K"</span>, <span class="string">"项目图片"</span>);</span><br><span class="line"><span class="comment">// 2.尾部设置，一般可以用来设计合计栏</span></span><br><span class="line">HashMap&lt;String, String&gt; footerRules = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">footerRules.put(<span class="string">"1,2,A,C"</span>, <span class="string">"注释:"</span>);</span><br><span class="line">footerRules.put(<span class="string">"1,2,D,K"</span>, <span class="string">"导出参考代码！"</span>);</span><br><span class="line"><span class="comment">// 3.导出hearder对应的字段设置</span></span><br><span class="line">Column[] column = &#123;</span><br><span class="line">        Column.field(<span class="string">"projectName"</span>),</span><br><span class="line">        <span class="comment">// 4.1设置此列宽度为10</span></span><br><span class="line">        Column.field(<span class="string">"areaName"</span>).width(<span class="number">10</span>),</span><br><span class="line">        <span class="comment">// 4.2设置此列下拉框数据</span></span><br><span class="line">        Column.field(<span class="string">"province"</span>).width(<span class="number">5</span>).dorpDown(<span class="keyword">new</span> String[]&#123;<span class="string">"陕西省"</span>, <span class="string">"山西省"</span>, <span class="string">"辽宁省"</span>&#125;),</span><br><span class="line">        <span class="comment">// 4.3设置此列水平居右</span></span><br><span class="line">        Column.field(<span class="string">"city"</span>).align(HorizontalAlignment.RIGHT),</span><br><span class="line">        <span class="comment">// 4.4 设置此列垂直居上</span></span><br><span class="line">        Column.field(<span class="string">"people"</span>).valign(VerticalAlignment.TOP),</span><br><span class="line">        <span class="comment">// 4.5 设置此列单元格 自定义校验 只能输入文本</span></span><br><span class="line">        Column.field(<span class="string">"leader"</span>).width(<span class="number">4</span>).verifyCustom(<span class="string">"VALUE(F3:F500)"</span>, <span class="string">"我是提示"</span>),</span><br><span class="line">        <span class="comment">// 4.6设置此列单元格 整数 数据校验 ，同时设置背景色为棕色</span></span><br><span class="line">        Column.field(<span class="string">"scount"</span>).verifyIntNum(<span class="string">"10~20"</span>).backColor(IndexedColors.BROWN),</span><br><span class="line">        <span class="comment">// 4.7设置此列单元格 浮点数 数据校验， 同时设置字体颜色红色</span></span><br><span class="line">        Column.field(<span class="string">"avg"</span>).verifyFloatNum(<span class="string">"10.0~20.0"</span>).color(IndexedColors.RED),</span><br><span class="line">        <span class="comment">// 4.8设置此列单元格 日期 数据校验 ，同时宽度为20、限制用户表格输入、水平居中、垂直居中、背景色、字体颜色</span></span><br><span class="line">        Column.field(<span class="string">"createTime"</span>).width(<span class="number">20</span>).verifyDate(<span class="string">"2000-01-03 12:35~3000-05-06 23:23"</span>)</span><br><span class="line">                .align(HorizontalAlignment.LEFT).valign(VerticalAlignment.CENTER)</span><br><span class="line">                .backColor(IndexedColors.YELLOW).color(IndexedColors.GOLD),</span><br><span class="line">        <span class="comment">// 4.9项目图片</span></span><br><span class="line">        Column.field(<span class="string">"img"</span>)</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 4.执行导出到工作簿</span></span><br><span class="line">Workbook bean = ExcelUtils.createWorkbook(</span><br><span class="line">        sheetData,</span><br><span class="line">        ExportRules.complexRule(column, headerRules).autoNum(<span class="keyword">true</span>).footerRules(footerRules).sheetName(<span class="string">"mysheet2"</span>),</span><br><span class="line">        <span class="keyword">true</span>,</span><br><span class="line">        (fieldName, value, row, col) -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">"projectName"</span>.equals(fieldName) &amp;&amp; row.getProjectName().equals(<span class="string">"中青旅23"</span>)) &#123;</span><br><span class="line">                col.align(HorizontalAlignment.LEFT);</span><br><span class="line">                col.valign(VerticalAlignment.CENTER);</span><br><span class="line">                col.height(<span class="number">2</span>);</span><br><span class="line">                col.backColor(IndexedColors.RED);</span><br><span class="line">                col.color(IndexedColors.YELLOW);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;);</span><br><span class="line"><span class="comment">// 5.写出文件</span></span><br><span class="line">bean.write(<span class="keyword">new</span> FileOutputStream(<span class="string">"src/test/java/excel/export/export2.xlsx"</span>));</span><br></pre></td></tr></table></figure>

<h4 id="2导出图"><a href="#2导出图" class="headerlink" title="2导出图"></a>2导出图</h4><p><img src="https://images.gitee.com/uploads/images/2018/1215/161814_61f83ff1_1215820.png" alt="输入图片说明" title="2.png"></p>
<p>3.复杂的对象级联导出</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 1.导出的hearder设置</span></span><br><span class="line">String[] hearder = &#123;<span class="string">"學生姓名"</span>, <span class="string">"所在班級"</span>, <span class="string">"所在學校"</span>, <span class="string">"更多父母姓名"</span>&#125;;</span><br><span class="line"><span class="comment">// 2.导出hearder对应的字段设置，列宽设置</span></span><br><span class="line">Column[] column = &#123;Column.field(<span class="string">"name"</span>), Column.field(<span class="string">"classRoom.name"</span>), Column.field(<span class="string">"classRoom.school.name"</span>),</span><br><span class="line">        Column.field(<span class="string">"moreInfo.parent.name"</span>),&#125;;</span><br><span class="line"><span class="comment">// 3.执行导出到工作簿</span></span><br><span class="line">Workbook bean = ExcelUtils.createWorkbook(complexData, ExportRules.simpleRule(column, hearder).title(<span class="string">"學生基本信息"</span>), <span class="keyword">true</span>);</span><br><span class="line"><span class="comment">// 4.写出文件</span></span><br><span class="line">bean.write(<span class="keyword">new</span> FileOutputStream(<span class="string">"src/test/java/excel/export/export3.xlsx"</span>));</span><br></pre></td></tr></table></figure>

<h4 id="3导出图"><a href="#3导出图" class="headerlink" title="3导出图"></a>3导出图</h4><p><img src="https://images.gitee.com/uploads/images/2018/1209/193615_b483f034_1215820.png" alt="输入图片说明" title="4.png"></p>
<p>4.map对象的简单导出</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.导出的hearder设置</span></span><br><span class="line">String[] hearder = &#123;<span class="string">"姓名"</span>, <span class="string">"年龄"</span>&#125;;</span><br><span class="line"><span class="comment">// 2.导出hearder对应的字段设置，列宽设置</span></span><br><span class="line">Column[] column = &#123;Column.field(<span class="string">"name"</span>),</span><br><span class="line">        Column.field(<span class="string">"age"</span>),</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 3.执行导出到工作簿</span></span><br><span class="line">Workbook bean = ExcelUtils.createWorkbook(mapData, ExportRules.simpleRule(column, hearder), <span class="keyword">true</span>);</span><br><span class="line"><span class="comment">// 4.写出文件</span></span><br><span class="line">bean.write(<span class="keyword">new</span> FileOutputStream(<span class="string">"src/test/java/excel/export/export4.xlsx"</span>));</span><br></pre></td></tr></table></figure>

<h4 id="4导出图"><a href="#4导出图" class="headerlink" title="4导出图"></a>4导出图</h4><p><img src="https://images.gitee.com/uploads/images/2018/1209/193608_c75b81ee_1215820.png" alt="输入图片说明" title="4.png"></p>
<p>5.模板导出</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 1.导出的hearder设置</span></span><br><span class="line">String[] hearder = &#123;<span class="string">"宝宝姓名"</span>, <span class="string">"宝宝昵称"</span>, <span class="string">"家长姓名"</span>, <span class="string">"手机号码"</span>, <span class="string">"宝宝生日"</span>, <span class="string">"月龄"</span>, <span class="string">"宝宝性别"</span>, <span class="string">"来源渠道"</span>, <span class="string">"市场人员"</span>, <span class="string">"咨询顾问"</span>, <span class="string">"客服顾问"</span>,</span><br><span class="line">    <span class="string">"分配校区"</span>, <span class="string">"备注"</span>&#125;;</span><br><span class="line"><span class="comment">// 2.导出hearder对应的字段设置，列宽设置</span></span><br><span class="line">Column[] column = &#123;Column.field(<span class="string">"宝宝姓名"</span>), Column.field(<span class="string">"宝宝昵称"</span>), Column.field(<span class="string">"家长姓名"</span>),</span><br><span class="line">    Column.field(<span class="string">"手机号码"</span>).verifyText(<span class="string">"11~11"</span>, <span class="string">"请输入11位的手机号码！"</span>),</span><br><span class="line">    Column.field(<span class="string">"宝宝生日"</span>).verifyDate(<span class="string">"2000-01-01~3000-12-31"</span>),</span><br><span class="line">    Column.field(<span class="string">"月龄"</span>).width(<span class="number">4</span>).verifyCustom(<span class="string">"VALUE(F3:F6000)"</span>, <span class="string">"月齡格式：如1年2个月则输入14"</span>),</span><br><span class="line">    Column.field(<span class="string">"宝宝性别"</span>).dorpDown(<span class="keyword">new</span> String[]&#123;<span class="string">"男"</span>, <span class="string">"女"</span>&#125;),</span><br><span class="line">    Column.field(<span class="string">"来源渠道"</span>).width(<span class="number">12</span>).dorpDown(<span class="keyword">new</span> String[]&#123;<span class="string">"品推"</span>, <span class="string">"市场"</span>&#125;),</span><br><span class="line">    Column.field(<span class="string">"市场人员"</span>).width(<span class="number">6</span>).dorpDown(<span class="keyword">new</span> String[]&#123;<span class="string">"张三"</span>, <span class="string">"李四"</span>&#125;),</span><br><span class="line">    Column.field(<span class="string">"咨询顾问"</span>).width(<span class="number">6</span>).dorpDown(<span class="keyword">new</span> String[]&#123;<span class="string">"张三"</span>, <span class="string">"李四"</span>&#125;),</span><br><span class="line">    Column.field(<span class="string">"客服顾问"</span>).width(<span class="number">6</span>).dorpDown(<span class="keyword">new</span> String[]&#123;<span class="string">"大唐"</span>, <span class="string">"银泰"</span>&#125;),</span><br><span class="line">    Column.field(<span class="string">"分配校区"</span>).width(<span class="number">6</span>).dorpDown(<span class="keyword">new</span> String[]&#123;<span class="string">"大唐"</span>, <span class="string">"银泰"</span>&#125;), Column.field(<span class="string">"备注"</span>)&#125;;</span><br><span class="line"><span class="comment">// 3.执行导出到工作簿</span></span><br><span class="line">Workbook bean = ExcelUtils.createWorkbook(Collections.emptyList(), ExportRules.simpleRule(column, hearder), <span class="keyword">true</span>);</span><br><span class="line"><span class="comment">// 4.写出文件</span></span><br><span class="line">bean.write(<span class="keyword">new</span> FileOutputStream(<span class="string">"src/test/java/excel/export/export5.xlsx"</span>));</span><br></pre></td></tr></table></figure>

<h4 id="5导出图"><a href="#5导出图" class="headerlink" title="5导出图"></a>5导出图</h4><p><img src="https://images.gitee.com/uploads/images/2018/1215/180646_50cc4004_1215820.png" alt="输入图片说明" title="5.png"></p>
<p>6.多sheet合并导出</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 1.导出的hearder设置</span></span><br><span class="line">Workbook emptyWorkbook = ExcelUtils.createEmptyWorkbook(<span class="keyword">true</span>);</span><br><span class="line"><span class="comment">// 2.执行导出到工作簿.1.项目数据2.map数据3.复杂对象数据</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; moreSheetData.size(); i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">0</span>) &#123;</span><br><span class="line">        List&lt;ProjectEvaluate&gt; data1 = (ArrayList&lt;ProjectEvaluate&gt;) moreSheetData.get(i);</span><br><span class="line">        <span class="comment">// 1.导出的hearder设置</span></span><br><span class="line">        String[] hearder = &#123;<span class="string">"序号"</span>, <span class="string">"项目名称"</span>, <span class="string">"所属区域"</span>, <span class="string">"省份"</span>, <span class="string">"市"</span>, <span class="string">"项目所属人"</span>, <span class="string">"项目领导人"</span>, <span class="string">"得分"</span>, <span class="string">"平均分"</span>, <span class="string">"创建时间"</span>, <span class="string">"项目图片"</span>&#125;;</span><br><span class="line">        <span class="comment">// 2.导出hearder对应的字段设置</span></span><br><span class="line">        Column[] column = &#123;Column.field(<span class="string">"projectName"</span>), Column.field(<span class="string">"areaName"</span>), Column.field(<span class="string">"province"</span>),</span><br><span class="line">                Column.field(<span class="string">"city"</span>), Column.field(<span class="string">"people"</span>), Column.field(<span class="string">"leader"</span>), Column.field(<span class="string">"scount"</span>),</span><br><span class="line">                Column.field(<span class="string">"avg"</span>), Column.field(<span class="string">"createTime"</span>),</span><br><span class="line">                <span class="comment">// 项目图片</span></span><br><span class="line">                Column.field(<span class="string">"img"</span>)</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line">        ExcelUtils.fillBook(emptyWorkbook, data1, ExportRules.simpleRule(column, hearder).title(<span class="string">"项目资源统计"</span>).sheetName(<span class="string">"mysheet1"</span>).autoNum(<span class="keyword">true</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">1</span>) &#123;</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; data2 = (ArrayList&lt;Map&lt;String, Object&gt;&gt;) moreSheetData.get(i);</span><br><span class="line">        <span class="comment">// 1.导出的hearder设置</span></span><br><span class="line">        String[] hearder = &#123;<span class="string">"姓名"</span>, <span class="string">"年龄"</span>&#125;;</span><br><span class="line">        <span class="comment">// 2.导出hearder对应的字段设置，列宽设置</span></span><br><span class="line">        Column[] column = &#123;Column.field(<span class="string">"name"</span>),</span><br><span class="line">                Column.field(<span class="string">"age"</span>),</span><br><span class="line">        &#125;;</span><br><span class="line">        ExcelUtils.fillBook(emptyWorkbook, data2, ExportRules.simpleRule(column, hearder).sheetName(<span class="string">"mysheet2"</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">2</span>) &#123;</span><br><span class="line">        List&lt;Student&gt; data3 = (ArrayList&lt;Student&gt;) moreSheetData.get(i);</span><br><span class="line">        <span class="comment">// 1.导出的hearder设置</span></span><br><span class="line">        String[] hearder = &#123;<span class="string">"學生姓名"</span>, <span class="string">"所在班級"</span>, <span class="string">"所在學校"</span>, <span class="string">"更多父母姓名"</span>&#125;;</span><br><span class="line">        <span class="comment">// 2.导出hearder对应的字段设置，列宽设置</span></span><br><span class="line">        Column[] column = &#123;Column.field(<span class="string">"name"</span>), Column.field(<span class="string">"classRoom.name"</span>), Column.field(<span class="string">"classRoom.school.name"</span>),</span><br><span class="line">                Column.field(<span class="string">"moreInfo.parent.name"</span>),&#125;;</span><br><span class="line">        <span class="comment">// 3.执行导出到工作簿</span></span><br><span class="line">        ExcelUtils.fillBook(emptyWorkbook, data3, ExportRules.simpleRule(column, hearder).title(<span class="string">"學生基本信息"</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 4.写出文件</span></span><br><span class="line">emptyWorkbook.write(<span class="keyword">new</span> FileOutputStream(<span class="string">"src/test/java/excel/export/export6.xlsx"</span>));</span><br></pre></td></tr></table></figure>
    </div>

    <div>全文完。</div>
  </article>
  <div class="toc-container">
    
  <div id="toc" class="toc-article">
    <strong class="toc-title">目录</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#excel-poi"><span class="toc-text">excel-poi</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#maven使用方式"><span class="toc-text">maven使用方式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#前言"><span class="toc-text">前言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#导入"><span class="toc-text">导入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#导出"><span class="toc-text">导出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#选择03还是07？"><span class="toc-text">选择03还是07？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#主要功能："><span class="toc-text">主要功能：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#导入-1"><span class="toc-text">导入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#导入示例图"><span class="toc-text">导入示例图</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#导出-1"><span class="toc-text">导出</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1导出图"><span class="toc-text">1导出图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2导出图"><span class="toc-text">2导出图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3导出图"><span class="toc-text">3导出图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4导出图"><span class="toc-text">4导出图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5导出图"><span class="toc-text">5导出图</span></a></li></ol></li></ol></li></ol></li></ol>
  </div>


  </div>
</div>
<div class="copyright">
    <span>注:文章部分来源为转载，会注明出处，每天坚持从外边砍柴！</span>
</div>

<div class="share" style="width: 100%;">
  
</div>

  
    <div class="post-nav">
      <div class="post-nav-item post-nav-next">
        
          <span>〈 </span>
          <a href="/2020/03/17/RedisKey%E8%AE%BE%E8%AE%A1%E7%B1%BB/" rel="next" title="RedisKey设计类">
          RedisKey设计类
          </a>
        
      </div>
  
      <div class="post-nav-item post-nav-prev">
          
          <a href="/2020/03/24/%E3%80%9063%E6%9C%9F%E3%80%91%E8%B0%88%E8%B0%88MySQL_%E7%B4%A2%E5%BC%95%EF%BC%8CB+%E6%A0%91%E5%8E%9F%E7%90%86%EF%BC%8C%E4%BB%A5%E5%8F%8A%E5%BB%BA%E7%B4%A2%E5%BC%95%E7%9A%84%E5%87%A0%E5%A4%A7%E5%8E%9F%E5%88%99%EF%BC%88MySQL%E9%9D%A2%E8%AF%95%E7%AC%AC%E5%85%AD%E5%BC%B9%EF%BC%89/" rel="prev" title="【63期】谈谈MySQL 索引，B+树原理，以及建索引的几大原则（MySQL面试第六弹）">
            【63期】谈谈MySQL 索引，B+树原理，以及建索引的几大原则（MySQL面试第六弹）
          </a>
          <span>〉</span>
        
      </div>
    </div>
  

  <section class="disqus-comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
    </div>
  </section>

  <script>
    var disqus_shortname = 'XXX';
    
    var disqus_url = 'https://kanchai.club/2020/03/17/excel/';
    
    (function(){
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>

  <script id="dsq-count-scr" src="//XXX.disqus.com/count.js" async></script>



    </div>

    

  </div>
  <footer class="footer text-center">
    <div id="bottom-inner">
        <a class="bottom-item" href="https://kanchai.club">首页</a> |
        <a class="bottom-item" href="https://www.zhihu.com/people/lt625" target="_blank">知乎</a> |
        <a class="bottom-item" href="https://github.com/stupdit1t" target="_blank">GitHub</a> |
        <a class="bottom-item" href="http://www.beian.miit.gov.cn/" target="_blank">陕ICP备18020347号</a>
    </div>
</footer>

  

<script>
  (function(window, document, undefined) {

    var timer = null;

    function returnTop() {
      cancelAnimationFrame(timer);
      timer = requestAnimationFrame(function fn() {
        var oTop = document.body.scrollTop || document.documentElement.scrollTop;
        if (oTop > 0) {
          document.body.scrollTop = document.documentElement.scrollTop = oTop - 50;
          timer = requestAnimationFrame(fn);
        } else {
          cancelAnimationFrame(timer);
        }
      });
    }

    var hearts = [];
    window.requestAnimationFrame = (function() {
      return window.requestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        window.oRequestAnimationFrame ||
        window.msRequestAnimationFrame ||
        function(callback) {
          setTimeout(callback, 1000 / 60);
        }
    })();
    init();

    function init() {
      css(".heart{z-index:9999;width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: absolute;}.heart:after{top: -5px;}.heart:before{left: -5px;}");
      attachEvent();
      gameloop();
      addMenuEvent();
    }

    function gameloop() {
      for (var i = 0; i < hearts.length; i++) {
        if (hearts[i].alpha <= 0) {
          document.body.removeChild(hearts[i].el);
          hearts.splice(i, 1);
          continue;
        }
        hearts[i].y--;
        hearts[i].scale += 0.004;
        hearts[i].alpha -= 0.013;
        hearts[i].el.style.cssText = "left:" + hearts[i].x + "px;top:" + hearts[i].y + "px;opacity:" + hearts[i].alpha + ";transform:scale(" + hearts[i].scale + "," + hearts[i].scale + ") rotate(45deg);background:" + hearts[i].color;
      }
      requestAnimationFrame(gameloop);
    }

    /**
     * 给logo设置点击事件
     * 
     * - 回到顶部
     * - 出现爱心
     */
    function attachEvent() {
      var old = typeof window.onclick === "function" && window.onclick;
      var logo = document.getElementById("logo");
      if (logo) {
        logo.onclick = function(event) {
          returnTop();
          old && old();
          createHeart(event);
        }
      }
      
    }

    function createHeart(event) {
      var d = document.createElement("div");
      d.className = "heart";
      hearts.push({
        el: d,
        x: event.clientX - 5,
        y: event.clientY - 5,
        scale: 1,
        alpha: 1,
        color: randomColor()
      });
      document.body.appendChild(d);
    }

    function css(css) {
      var style = document.createElement("style");
      style.type = "text/css";
      try {
        style.appendChild(document.createTextNode(css));
      } catch (ex) {
        style.styleSheet.cssText = css;
      }
      document.getElementsByTagName('head')[0].appendChild(style);
    }

    function randomColor() {
      // return "rgb(" + (~~(Math.random() * 255)) + "," + (~~(Math.random() * 255)) + "," + (~~(Math.random() * 255)) + ")";
      return "#F44336";
    }

    function addMenuEvent() {
      var menu = document.getElementById('menu-main-post');
      if (menu) {
        var toc = document.getElementById('toc');
        if (toc) {
          menu.onclick = function() {
            if (toc) {
              if (toc.style.display == 'block') {
                toc.style.display = 'none';
              } else {
                toc.style.display = 'block';
              }
            }
          };
        } else {
          menu.style.display = 'none';
        }
      }
    }

  })(window, document);
</script>

  
  <script>
    var _hmt = _hmt || [];
    (function () {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?FuckUBaidu";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'XXX', 'auto');
      ga('send', 'pageview');
  </script>


</body>
</html>
